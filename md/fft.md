# 高速フーリエ変換

2 つの多項式 $f, g$ の積 $h$ を $O(n \log n)$ 時間で求める。

例えば、$f(x) = a_0 + a_1x + a_2x^2, g(x) = b_0 + b_1x$ のとき、$(f\cdot g)(x) = h(x) = c_0 + c_1x + c_2x^2 + c_3x^3$ を求めたい。これは $n = 4$ の例。
戦略としては、まず、4 点 $1, i, -1, -i$ (一般には、1 の $2^n$ 乗根の累乗) での $h(x) = f(x)g(x)$ の値を求めてから、補間によって、$h$ を求める。
実は補間も、$1, i, -1, -i$ での多項式の評価ができれば求まる。まずそれを示す。
$$
\begin{align*}
\hat{h}(x) & = h(1) + h(i)x + h(-1)x^2 + h(-i)x^3 \\
           & = [c_0 + c_1 + c_2 + c_3] \\
           & + [c_0 + c_1i + c_2i^2 + c_3i^3 ] x \\
           & + [c_0 + c_1i^2 + c_2i^4 + c_3i^6 ] x^2 \\
           & + [c_0 + c_1i^3 + c_2i^6 + c_3i^9 ] x^3 
\end{align*}
$$

とおく。$x=1$ で評価すると、この値は $nc_0$ となる。例えば、$x=i^{-3}$ とすると、3 つ左に回って、

$$
\begin{align*}
\hat{h}(i^{-3}) & = [c_3 + c_0    + c_1    + c_2]     \\
              & + [c_3 + c_0i   + c_1i^2 + c_2i^3 ] \\
              & + [c_3 + c_0i^2 + c_1i^4 + c_2i^6 ] \\
              & + [c_3 + c_0i^3 + c_1i^6 + c_2i^9 ] 
\end{align*}
$$
となって、この値は $nc_3$ となる。
一般の場合もこのように、$\hat{h}(x)$ を $\omega^{-k}$ ($\omega$ は 1 の $n$ 乗根) で評価し、$n$ で割ることによって、$c_k$ が求まる。


$h(x) = f(x)g(x)$ であるので、$f$ について $f(1), f(i), f(-1), f(-i)$ を求める方法を示す。

$f_0(x) = a_0 + a_2x$, $f_1(x) = a_1 + a_3x$ とおくと、 $f(x) = f_0(x^2) + xf_1(x^2)$ と表され、

$$
\begin{align*}
f(1)  &= f_0(1)  + 1 f_1(1) \\
f(i)  &= f_0(-1) + i f_1(-1) \\
f(-1) &= f_0(1)  + (-1) f_1(1) \\
f(-i) &= f_0(-1) + (-i) f_1(-1) \\
\end{align*}
$$ 

となるから、これらの値が求まるためには、$f_0(1), f_0(-1)$ と、$f_1(1), f_1(-1)$ の値が求まればよい。半分のサイズの問題 2 つに帰着できたことから、これらを再帰的に求めることで、$O(n \log n)$ 時間のアルゴリズムが得られた。
一般には、$f(\omega^k) = f_0(\omega'^ k) + \omega^k f_1(\omega' ^k)$ という式になる。

## ソースコード
https://github.com/ogiekako/contest/search?utf8=%E2%9C%93&q=fft+language%3AJava+path%3Amain%2Fnet%2Fogiekako&type=Code
